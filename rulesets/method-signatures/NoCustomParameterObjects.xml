<?xml version="1.0" ?>
<ruleset
	name="Apex Method Signature Rules"
	xmlns="http://pmd.sourceforge.net/ruleset/2.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://pmd.sourceforge.net/ruleset/2.0.0 https://pmd.sourceforge.io/ruleset_2_0_0.xsd"
>
	<description>Custom rules for Apex method signatures and parameters</description>

	<rule
		name="NoCustomParameterObjects"
		language="apex"
		message="Custom classes, inner classes, or wrapper objects should not be created solely for passing parameters. Refactor methods to stay within 3 parameters instead"
		class="net.sourceforge.pmd.lang.rule.xpath.XPathRule"
	>
		<description>
			Custom parameter objects (classes or inner classes that only have attributes and
			constructors with no instance methods) should not be created solely for passing parameters.
			Instead, refactor methods to stay within 3 parameters, which improves readability and follows best
			practices for method design.
			The rule flags inner classes with a number of fields greater than or equal to minFields (inclusive),
			configurable via properties.
		</description>
		<priority>3</priority>
		<properties>
			<property
				name="minFields"
				type="String"
				description="Minimum number of fields (inclusive) to trigger the rule"
			>
				<value>1</value>
			</property>
			<property name="xpath">
				<value>
                    <![CDATA[
                    //UserClass[
                        count(Method) = 0
                        and count(Field) >= number(if ('${minFields}' = '${minFields}') then '1' else '${minFields}')
                        and @Nested = true()
                        and not(Field/ModifierNode/Annotation[@Name = 'InvocableVariable'])
                    ]
                    ]]>
                </value>
			</property>
		</properties>
	</rule>
</ruleset>
